@model ExperienceDetails

@{
    ViewData["Title"] = "Edit Experience";
}

<h1>Edit Experience</h1>
<hr />
<div class="row">
    <div class="col-md-6">
        <form method="POST" asp-action="Update" asp-route-id="@Model.Experience.ExperienceId">
            <input type="hidden" name="ExperienceId" value="@Model.Experience.ExperienceId" />

            <div class="form-group">
                <label for="ExperienceName">Experience Name:</label>
                <input type="text" name="ExperienceName" value="@Model.Experience.ExperienceName" class="form-control" required />
            </div>

            <div class="form-group">
                <label for="HobbyId">Hobby:</label>
                <select name="HobbyId" class="form-control">
                    @foreach (var hobby in Model.HobbyOptions)
                    {
                        <option value="@hobby.HobbyId" selected="@(hobby.HobbyId == Model.Experience.HobbyId ? "selected" : null)">
                            @hobby.HobbyName
                        </option>
                    }
                </select>
            </div>

            <div class="form-group">
                <label for="ExperienceDate">Date:</label>
                <input type="date" name="ExperienceDate" value="@Model.Experience.ExperienceDate.ToString("yyyy-MM-dd")" class="form-control" required />
            </div>

            <div class="form-group">
                <label for="ExperienceLocation">Location:</label>
                <input type="text" name="ExperienceLocation" value="@Model.Experience.ExperienceLocation" class="form-control" />
            </div>

            <div class="form-group">
                <label for="DurationinHours">Duration (hours):</label>
                <input type="number" step="0.1" name="DurationinHours" value="@Model.Experience.DurationinHours" class="form-control" />
            </div>

            <div class="form-group">
                <label for="ExperienceCost">Cost ($):</label>
                <input type="number" step="0.01" name="ExperienceCost" value="@Model.Experience.ExperienceCost" class="form-control" />
            </div>

            <br />
            <div class="form-group">
                <input type="submit" value="Save Changes" class="btn btn-primary" />
                <a asp-action="Details" asp-route-id="@Model.Experience.ExperienceId" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>


    <div class="col-md-6">
        <h3 class="mt-4">Moods</h3>
        @if (Model.ExperienceMoods.Any())
        {
            <ul id="moodList">
                @foreach (var mood in Model.ExperienceMoods)
                {
                    <li id="mood-@mood.ExperienceMoodId">
                  
                            <form class="update-mood-form" method="POST" asp-action="UpdateExperienceMood" asp-route-id="@mood.ExperienceMoodId" style="display: inline;"  >
                                <input type="hidden" name="ExperienceMoodId" value="@mood.ExperienceMoodId" />
                                <input type="hidden" name="ExperienceId" value="@Model.Experience.ExperienceId" />
                                <input type="hidden" name="MoodId" value="@mood.MoodId" />

                                @mood.MoodName - Before:
                                <input type="number" name="BeforeIntensity" value="@mood.MoodIntensityBefore" min="0" max="10" style="width: 50px;" />
                                | After:
                                <input type="number" name="AfterIntensity" value="@mood.MoodIntensityAfter" min="0" max="10" style="width: 50px;" />

                            
                            </form>

                            <form method="POST" asp-action="UnlinkMood" style="display: inline;">
                                <input type="hidden" name="ExperienceMoodId" value="@mood.ExperienceMoodId" />
                                <input type="hidden" name="ExperienceId" value="@Model.Experience.ExperienceId" />
                                <input type="hidden" name="MoodId" value="@mood.MoodId" />
                                <button type="submit" class="btn btn-sm btn-danger">Remove</button>
                            </form>

                    </li>
                }
            </ul>
        }
        else
        {
            <p>No moods recorded for this experience.</p>
        }

        <h4>Add a Mood</h4>
        <form method="POST" asp-action="LinkMood">
            <select name="moodId" class="form-control">
                @foreach (var mood in Model.MoodOptions)
                {
                    <option value="@mood.MoodId">@mood.MoodName</option>
                }
            </select>

            <label for="BeforeIntensity">Intensity Before:</label>
            <input type="number" name="BeforeIntensity" min="0" max="10" style="width: 50px;" />

            <label for="AfterIntensity">Intensity After:</label>
            <input type="number" name="AfterIntensity" min="0" max="10" style="width: 50px;" />

            <input type="hidden" name="experienceId" value="@Model.Experience.ExperienceId" />
            <input type="submit" value="Add Mood" class="btn btn-primary" />
        </form>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}


